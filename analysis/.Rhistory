setwd("~/Documents/si-quant/implicatures_comps/implicatures_comps_analyses")
rm(list=ls())
library(lme4)
library(plotrix)
library(ggplot2)
library(diptest)
library(plyr)
d1 <- read.csv("implicatures_adhocScalar_data.csv")
install.packages("diptest")
rm(list=ls())
library(lme4)
library(plotrix)
library(ggplot2)
library(diptest)
library(plyr)
d1 <- read.csv("implicatures_adhocScalar_data.csv")
library(reshape)
d2=melt.data.frame(d1,c("Subj_ID","experimenter", "age","agegroup", "list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_condition", "hats_condition", "cookies_condition", "trains_condition", "cats_condition", "purses_condition",  "keys_condition", "shirts_condition", "breads_condition", "horses_condition", "bears_condition", "frogs_condition", "plates_condition", "books_condition", "elephants_condition", "lamps_condition", "bananas_condition", "butterflies_condition",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
View(d1)
library(reshape)
d2=melt.data.frame(d1,c("Subj_ID", "age","agegroup", "list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_condition", "hats_condition", "cookies_condition", "trains_condition", "cats_condition", "purses_condition",  "keys_condition", "shirts_condition", "breads_condition", "horses_condition", "bears_condition", "frogs_condition", "plates_condition", "books_condition", "elephants_condition", "lamps_condition", "bananas_condition", "butterflies_condition",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
View(d2)
data <- d2[1:864,]
data$condition <- d2$value[865:1728]
data$type <- d2$value[1729:2592]
names(data)[6] <- "item"
names(data)[7] <- "correct"
data$older <- (data$age>4.5)
data$correct <- data$correct==1
attach(data)
data$trial_type[type == "implicature"] <- "implicature"
data$trial_type[type != "implicature"] <- "control"
detach(data)
attach(data)
data$value[1:432] <- "firstHalf"
data$value[433:864] <- "secondHalf"
detach(data)
names(data)[12] <- "half"
library(dplyr)
d_age <- d2 %>%
mutate(younger = agegroup == "4.0--4.5")
View(d_age)
d_age <- d2 %>%
mutate(younger = agegroup == "4.0--4.5", older = agegroup == "4.5--5.0")
?sd
?mean
d_age <- d2 %>%
mutate(younger = agegroup == "4.0--4.5", older = agegroup == "4.5--5.0")%>%
group_by(agegroup)%>%
summarise(m = mean(age))
View(d_age)
d_age <- d2 %>%
mutate(younger = agegroup == "4.0--4.5", older = agegroup == "4.5--5.0")%>%
group_by(agegroup)%>%
summarise(m = mean(age), std = sd(age), mode = mode(age))
View(d_age)
?mode
?median
library(dplyr)
d_age <- d2 %>%
mutate(younger = agegroup == "4.0--4.5", older = agegroup == "4.5--5.0")%>%
group_by(agegroup)%>%
summarise(m = mean(age), std = sd(age), median = median(age))
View(d_age)
View(d2)
setwd("~/Documents/si-quant/analysis")
setwd("~/Documents/si-quant/analysis")
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
library(knitr)
opts_chunk$set(cache=TRUE, message=FALSE, warning=FALSE)
rm(list=ls())
library(ggplot2)
library(reshape)
library(plyr)
library(dplyr)
library(stringr)
library(tidyr)
library(markdown)
library(directlabels)
library(magrittr)
library(bootstrap)
library(RCurl)
theme_set(theme_bw())
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
data_exp2 <- data_exp2[1:918,]
data_exp2$selectionType <- data_exp2$value[919:1836]
data_exp2$type <- data_exp2$value[1837:2754]
names(data_exp2)[5] <- "item"
names(data_exp2)[6] <- "correct"
View(data_exp2)
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
data_exp2 <- data_exp2[1:918,]
data_exp2$selectionType <- data_exp2$value[919:1836]
data_exp2$type <- data_exp2$value[1837:2754]
View(data_exp2)
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
data_exp2 <- data_exp2[1:918,]
View(data_exp2)
data_exp2$selectionType <- data_exp2$value[919:1836]
data_exp2$type <- data_exp2$value[1837:2754]
View(data_exp2)
data_exp2 <- data_exp2[1:918,]
data_exp2$selectionType <- data_exp2$value[919:1836]
data_exp2$type <- data_exp2$value[1837:2754]
names(data_exp2)[5] <- "item"
names(data_exp2)[6] <- "correct"
data_exp2 <- data_exp2[1:918,]
data_exp2$selectionType <- data_exp2$value[919:1836]
data_exp2$type <- data_exp2$value[1837:2754]
names(data_exp2)[5] <- "item"
names(data_exp2)[6] <- "correct"
View(data_exp2)
data_exp2$correct <- data_exp2$correct==1
#data$older <- (data$age>4.5)
data_exp2$correct <- data_exp2$correct==1
attach(data_exp2)
data_exp2$trial_type[type == "some"] <- "implicature"
data_exp2$trial_type[type != "some"] <- "control"
detach(data_exp2)
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
View(d2)
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2 <- data_exp2[1:918,]
d2 <- read.csv("../data/implicatures_scalarOnly_data.csv")
data_exp2=melt.data.frame(d2,c("Subj_ID","age","agegroup","list"),c("carrots", "hats", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies",
"carrots_selectionType", "hats_selectionType", "cookies_selectionType", "trains_selectionType", "cats_selectionType", "purses_selectionType",  "keys_selectionType", "shirts_selectionType", "breads_selectionType", "horses_selectionType", "bears_selectionType", "frogs_selectionType", "plates_selectionType", "books_selectionType", "elephants_selectionType", "lamps_selectionType", "bananas_selectionType", "butterflies_selectionType",
"carrots_type", "hats_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
data <- data_exp2[1:918,]
data$selectionType <- data_exp2$value[919:1836]
data$type <- data_exp2$value[1837:2754]
names(data)[5] <- "item"
names(data)[6] <- "correct"
View(data)
data_exp2 <- data
#data$older <- (data$age>4.5)
data_exp2$correct <- data_exp2$correct==1
attach(data_exp2)
data_exp2$trial_type[type == "some"] <- "implicature"
data_exp2$trial_type[type != "some"] <- "control"
detach(data_exp2)
View(data_exp2)
agg.data_2 <- aggregate(data_exp2$correct, list( data_exp2$type, data_exp2$trial_type, data_exp2$agegroup), FUN=sum)
agg.data.len2 <- aggregate(data_exp2$correct, list(data_exp2$type, data_exp2$trial_type, data_exp2$agegroup), FUN=length)
agg.data_2$x <- agg.data_2$x
agg.data.len2$x <- agg.data.len2$x
data_exp2 %<>%
filter(Subj_ID != "", correct != "NA") %>%
mutate(agesplit = cut(age, breaks=c(3, 3.5, 4, 4.5, 5)),
agesplit = factor(agesplit,
labels=c("3-3.5 years", "3.5-4 years", "4-4.5 years", "4.5-5 years"))) %>%
filter(agesplit != "NA")
View(data_exp2)
agg.data_2 <- aggregate(data_exp2$correct, list( data_exp2$type, data_exp2$trial_type, data_exp2$agesplit), FUN=sum)
agg.data.len2 <- aggregate(data_exp2$correct, list(data_exp2$type, data_exp2$trial_type, data_exp2$agesplit), FUN=length)
agg.data_2$x <- agg.data_2$x
agg.data.len2$x <- agg.data.len2$x
names(agg.data) <- c( "trial_type", "implicature", "Age", "correct")
agg.data$total <- agg.data.len$x
agg.data$prop.corr <- agg.data$correct / agg.data$total
agg.data$q <- 1 - agg.data$prop.corr
agg.data$err <- sqrt((agg.data$prop.corr * agg.data$q) / agg.data$total)
agg.data_2 <- aggregate(data_exp2$correct, list( data_exp2$type, data_exp2$trial_type, data_exp2$agesplit), FUN=sum)
agg.data.len2 <- aggregate(data_exp2$correct, list(data_exp2$type, data_exp2$trial_type, data_exp2$agesplit), FUN=length)
agg.data_2$x <- agg.data_2$x
agg.data.len2$x <- agg.data.len2$x
names(agg.data_2) <- c( "trial_type", "implicature", "Age", "correct")
agg.data_2$total <- agg.data.len2$x
agg.data_2$prop.corr <- agg.data_2$correct / agg.data_2$total
agg.data_2$q <- 1 - agg.data_2$prop.corr
agg.data_2$err <- sqrt((agg.data_2$prop.corr * agg.data_2$q) / agg.data_2$total)
ggplot(data = agg.data_2,
aes(x=trial_type, y=prop.corr, fill=Age)) +
geom_bar(stat="identity", position = position_dodge())  + geom_errorbar(limits, position=dodge)+
ylab("Proportion correct") +
xlab("Trial Type") +
scale_fill_brewer(palette="Set1") + facet_grid(~implicature_type, scale="free_x")
dodge <- position_dodge(width=0.9)
limits <- aes(ymax = prop.corr + err, ymin=prop.corr - err)
ggplot(data = agg.data_2,
aes(x=trial_type, y=prop.corr, fill=Age)) +
geom_bar(stat="identity", position = position_dodge())  + geom_errorbar(limits, position=dodge)+
ylab("Proportion correct") +
xlab("Trial Type") +
scale_fill_brewer(palette="Set1") + facet_grid(~implicature_type, scale="free_x")
ggplot(data = agg.data_2,
aes(x=trial_type, y=prop.corr, fill=Age)) +
geom_bar(stat="identity", position = position_dodge())  + geom_errorbar(limits, position=dodge)+
ylab("Proportion correct") +
xlab("Trial Type") +
scale_fill_brewer(palette="Set1")
View(agg.data_2)
agg.data_2$trial_type <- factor(agg.data$trial_type,
levels = c("all","none",
"some"),
labels = c("All","None",
"Some"))
agg.data_2$trial_type <- factor(agg.data_2$trial_type,
levels = c("all","none",
"some"),
labels = c("All","None",
"Some"))
View(agg.data_2)
ggplot(data = agg.data_2,
aes(x=trial_type, y=prop.corr, fill=Age)) +
geom_bar(stat="identity", position = position_dodge())  + geom_errorbar(limits, position=dodge)+
ylab("Proportion correct") +
xlab("Trial Type") +
scale_fill_brewer(palette="Set1")
quartz()
ggplot(data = agg.data_2,
aes(x=trial_type, y=prop.corr, fill=Age)) +
geom_bar(stat="identity", position = position_dodge())  + geom_errorbar(limits, position=dodge)+
ylab("Proportion correct") +
xlab("Trial Type") +
scale_fill_brewer(palette="Set1")
scalarOnly_subs <- aggregate(correct ~ type + agesplit +  Subj_ID, data=data_exp2, mean)
t.test(subset(scalarOnly_subs, agesplit=="3.0--3.5" & type=="all")$correct, mu=0.5)
View(scalarOnly_subs)
View(scalarOnly_subs)
t.test(subset(scalarOnly_subs, agesplit=="3.0-3.5 years" & type=="all")$correct, mu=0.5)
t.test(subset(scalarOnly_subs, agesplit=="3-3.5 years" & type=="all")$correct, mu=0.5)
t.test(subset(scalarOnly_subs, agesplit=="3.5-4 years" & type=="all")$correct, mu=0.5)
t.test(subset(scalarOnly_subs, agesplit=="4-4.5 years" & type=="all")$correct, mu=0.5)
t.test(subset(scalarOnly_subs, agesplit=="4.5-5 years" & type=="none")$correct, mu=0.5)
setwd("~/Documents/si-quant/analysis")
library(knitr)
opts_chunk$set(cache=TRUE, message=FALSE, warning=FALSE)
rm(list=ls())
library(ggplot2)
library(reshape)
library(plyr)
library(dplyr)
library(stringr)
library(tidyr)
library(markdown)
library(directlabels)
library(magrittr)
library(bootstrap)
library(RCurl)
theme_set(theme_bw())
#reading in the original wide-form dataframe
d1 <- read.csv("../data/SI_coding.csv")
#fill in the selection types for easier analyses
d1 %<>%
mutate(carrot_selection = factor(carrot_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")),
hat_selection = factor(hat_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
cookies_selection = factor(cookies_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")),
trains_selection = factor(trains_selection, levels=c(1, 2, 3), labels = c("none", "all", "some")),
cats_selection = factor(cats_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
purses_selection = factor(purses_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")),
keys_selection = factor(keys_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")),
shirts_selection = factor(shirts_selection, levels=c(1, 2, 3), labels = c("some", "all", "none")),
breads_selection = factor(breads_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
horses_selection = factor(horses_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
bears_selection= factor(bears_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")),
frogs_selection = factor(frogs_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
plates_selection = factor(plates_selection, levels=c(1, 2, 3), labels = c("all", "some", "none")),
books_selection = factor(books_selection, levels=c(1, 2, 3), labels = c("none", "all", "some")),
elephants_selection = factor(elephants_selection, levels=c(1, 2, 3), labels = c("some", "all", "none")),
lamps_selection = factor(lamps_selection, levels=c(1, 2, 3), labels = c("none", "all", "some")),
bananas_selection = factor(bananas_selection, levels=c(1, 2, 3), labels = c("some", "all", "none")),
butterflies_selection = factor(butterflies_selection, levels=c(1, 2, 3), labels = c("none", "some", "all")))
d2=melt.data.frame(d1,c("sub_ID","test_age", "order", "training"),c("carrot", "hat", "cookies", "trains", "cats", "purses",  "keys", "shirts", "breads", "horses", "bears", "frogs", "plates", "books", "elephants", "lamps", "bananas", "butterflies", "carrot_selection", "hat_selection", "cookies_selection", "trains_selection", "cats_selection", "purses_selection",  "keys_selection", "shirts_selection", "breads_selection", "horses_selection", "bears_selection", "frogs_selection", "plates_selection", "books_selection", "elephants_selection", "lamps_selection", "bananas_selection", "butterflies_selection", "carrot_type", "hat_type", "cookies_type", "trains_type", "cats_type", "purses_type",  "keys_type", "shirts_type", "breads_type", "horses_type", "bears_type", "frogs_type", "plates_type", "books_type", "elephants_type", "lamps_type", "bananas_type", "butterflies_type"))
#making a respectable df
onethird <- (1/3)*nrow(d2)
data <- d2[1:onethird,]
data$selection <- d2$value[(onethird+1):(onethird*2)]
data$type <- d2$value[(2*onethird+1):nrow(d2)]
names(data)[5] <- "item"
names(data)[6] <- "SI_correct"
data$correct <- data$SI_correct==1
#filtering out NAs, adding agesplit
data %<>%
filter(sub_ID != "", correct != "NA") %>%
mutate(agesplit = cut(test_age, breaks=c(3, 3.5, 4, 4.5, 5)),
agesplit = factor(agesplit,
labels=c("3-3.5 years", "3.5-4 years", "4-4.5 years", "4.5-5 years"))) %>%
filter(agesplit != "NA")
#renaming for better-looking graphs
data$type %<>%
str_replace("control_all", "All")%>%
str_replace("control_none", "None")%>%
str_replace("implicature", "Implicature")
data$selection %<>%
str_replace("all", "All")%>%
str_replace("none", "None")%>%
str_replace("some", "Some")
#Find the Mean and median ages
age <- data %>%
mutate(split_2 = cut(test_age, breaks = c(3, 4, 5)))%>%
group_by(split_2)%>%
summarise(median_age = median(test_age))
#use this dataframe for stats
data_si <- data %>%
mutate(test = "Scalar Implicature")
View(age)
#Find the Mean and median ages
age <- data %>%
dplyr::select(sub_ID, agesplit) %>%
dplyr::distinct() %>%
group_by(agesplit)%>%
summarise(n=n())
View(age)
View(d2)
age <- data %>%
dplyr::select(sub_ID, test_age, agesplit) %>%
dplyr::distinct() %>%
group_by(agesplit)%>%
summarise(n=n(), avg = mean(test_age))
View(age)
